install.packages("tidyverse")
install.packages("ggplot")
library(tidyverse)
library(ggplot2)
 
dataNEW <- read.csv("/Users/embur/Downloads/EH17338EMPATHY_data_2023-06-16_1348.csv")

coviddataNEWParent <- dataNEW %>% select(redcap_event_name, cg_covid_q1, record_id) %>%  filter(redcap_event_name == "visit_1_parent_arm_1" | redcap_event_name == "visit_2_parent_arm_1")
coviddataNEWParent$redcap_event_name[coviddataNEWParent$redcap_event_name == "visit_1_parent_arm_1"] <- "PV1"
coviddataNEWParent$redcap_event_name[coviddataNEWParent$redcap_event_name == "visit_2_parent_arm_1"] <- "PV2"
coviddataNEWParent <- coviddataNEWParent %>% na.omit(coviddataNEWParent)

paindataNEWChild <- dataNEW %>% select(redcap_event_name, tanner_q3, record_id) %>%  filter(redcap_event_name == "visit_1_child_arm_1" | redcap_event_name == "visit2_child_arm_1")
paindataNEWChild$redcap_event_name[paindataNEWChild$redcap_event_name == "visit_1_child_arm_1"] <- "PV1"
paindataNEWChild$redcap_event_name[paindataNEWChild$redcap_event_name == "visit2_child_arm_1"] <- "PV2"
paindataNEWChild %>% na.omit(paindataNEWChild)

coviddataNEWParent$cg_covid_q1[coviddataNEWParent$cg_covid_q1 == 0] <- "No COVID-19 Diagnosis"
coviddataNEWParent$cg_covid_q1[coviddataNEWParent$cg_covid_q1 == 1] <- "Yes COVID-19 Diagnosis"

PV1datCov <- coviddataNEWParent %>% select(record_id, redcap_event_name, cg_covid_q1) %>% filter(redcap_event_name == "PV1") 
PV1datPain <- paindataNEWChild %>% select(tanner_q3, record_id, redcap_event_name) %>% filter(redcap_event_name == "PV1") %>% na.omit(PV1datPain)
PV1paincovid <- merge(x = PV1datCov, y = PV1datPain, by = "record_id")

ggplot(data = PV1paincovid, aes(x = tanner_q3, fill = factor(cg_covid_q1))) + geom_boxplot() +  coord_flip() 
+ labs(title = "Menstrual Pain Ratings by History of COVID-19 Diagnosis at PV1", x ="Menstrual Pain Self-Rating", fill = "History of COVID-19") 
+ theme_classic() + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position = "top")
